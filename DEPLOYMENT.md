# GitHub Actions Deployment Guide

This repository includes comprehensive GitHub Actions workflows for building, testing, and deploying the Tomorrow Guy Svelte app.

## Workflows Overview

### 1. **Build and Deploy (`deploy.yml`)**

- **Triggers**: Push to `main` branch, manual dispatch
- **Purpose**: Builds the app and deploys to GitHub Pages
- **Features**:
  - Runs type checking with `npm run check`
  - Builds production-ready static files
  - Deploys to GitHub Pages automatically
  - Only deploys from `main` branch

### 2. **Continuous Integration (`ci.yml`)**

- **Triggers**: Push/PR to `main` or `develop` branches
- **Purpose**: Tests the app on multiple Node.js versions
- **Features**:
  - Tests on Node.js 18 and 20
  - Runs type checking
  - Builds the application
  - Smoke test with preview server

### 3. **Release (`release.yml`)**

- **Triggers**: Git tags matching `v*.*.*` pattern
- **Purpose**: Creates GitHub releases with build artifacts
- **Features**:
  - Creates tar.gz and zip archives
  - Generates release notes automatically
  - Marks pre-releases for beta/alpha/rc tags

## Setup Instructions

### 1. Enable GitHub Pages

1. Go to your repository Settings
2. Navigate to "Pages" in the sidebar
3. Under "Source", select "GitHub Actions"
4. Save the settings

### 2. Repository Permissions (if needed)

The workflows include the necessary permissions, but if you encounter issues:

1. Go to Settings → Actions → General
2. Under "Workflow permissions", ensure "Read and write permissions" is selected
3. Check "Allow GitHub Actions to create and approve pull requests"

### 3. Branch Protection (recommended)

1. Go to Settings → Branches
2. Add a branch protection rule for `main`:
   - Require status checks to pass before merging
   - Select the "test" check from CI workflow
   - Require branches to be up to date before merging

## Deployment Process

### Automatic Deployment

1. Push changes to the `main` branch
2. GitHub Actions will automatically:
   - Run type checking
   - Build the production app
   - Deploy to GitHub Pages
3. Your site will be available at: `https://swn14.github.io/tomorrow-guy/`

### Manual Deployment

1. Go to the "Actions" tab in your repository
2. Select "Build and Deploy to GitHub Pages"
3. Click "Run workflow"
4. Select the `main` branch and click "Run workflow"

### Creating Releases

1. Create and push a git tag:
   ```bash
   git tag v1.0.0
   git push origin v1.0.0
   ```
2. GitHub Actions will automatically create a release with build artifacts

## Local Development

```bash
# Install dependencies
npm install

# Run development server
npm run dev

# Type checking
npm run check

# Build for production
npm run build

# Preview production build
npm run preview
```

## Environment Variables

The workflows set `NODE_ENV=production` during builds. If you need additional environment variables for your app:

1. Add them to your repository secrets (Settings → Secrets and variables → Actions)
2. Reference them in the workflow files under the `env:` section

## Troubleshooting

### Build Failures

- Check the Actions tab for detailed error logs
- Ensure all dependencies are listed in `package.json`
- Verify TypeScript types are correct (`npm run check`)

### Deployment Issues

- Confirm GitHub Pages is enabled and set to "GitHub Actions"
- Check that the `build` directory contains your static files
- Verify the SvelteKit static adapter configuration

### PWA Issues

- PWA assets are included in the build automatically
- Service worker is generated by `vite-plugin-pwa`
- Icons and manifest are copied from the `static` folder

## Workflow Status Badges

Add these to your main README.md:

```markdown
![CI](https://github.com/swn14/tomorrow-guy/workflows/CI/badge.svg)
![Deploy](https://github.com/swn14/tomorrow-guy/workflows/Build%20and%20Deploy%20to%20GitHub%20Pages/badge.svg)
```
